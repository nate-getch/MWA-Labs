<!DOCTYPE html>
<html>

<head>
  <title>
    <%= title %>
  </title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

<body>
  <h1>
    <%= title %>
  </h1>
  <form method="POST" class="form-horizontal col-md-4">
    <% if(error) { %>
      <p><%= error %></p>
        <% } %>
          <div class="form-group">
            <label class="control-label col-sm-2" for="name">Name:</label>
            <div class="col-sm-10">
              <input name="name" type="text" class="form-control" id="name" placeholder="Enter Name">
            </div>
          </div>

          <div class="form-group">
            <label class="control-label col-sm-2" for="category">Category:</label>
            <div class="col-sm-10">
              <input required name="category" type="text" class="form-control" id="category" placeholder="Enter category">
            </div>
          </div>

          <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
              <button type="submit" class="btn btn-default">Search</button>
            </div>
          </div>
          <input id="longt" type="hidden" name="longt" value="">
          <input id="lat" type="hidden" name="lat" value="">
  </form>
  <div class="col-md-4">
    <iframe id="gmap" src="" width="600" height="450" frameborder="0" style="border:0" allowfullscreen></iframe>
  </div>
  <% if(result) { %>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Category</th>
          <th>Latitude</th>
          <th>Longtiude</th>
        </tr>
      </thead>
      <tbody>
        <% for(let i in result){  %>
          <tr>
            <td>
              <%= result[i].name %>
            </td>
            <td>
              <%= result[i].category %>
            </td>
            <td>
              <%= result[i].location[1] %>
            </td>
            <td>
              <%= result[i].location[0] %>
            </td>
          </tr>
          <%  } %>
      </tbody>
    </table>
    <% } %>

      <script>
        var longt = document.getElementById("longt");
        var lat = document.getElementById("lat");
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          x.innerHTML = "Geolocation is not supported by this browser.";
        }

        function showPosition(position) {
          longt.value = position.coords.longitude;
          lat.value = position.coords.latitude; 
        }
      </script>
</body>

</html>